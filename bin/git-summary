#!/bin/bash

REPO_HOME="$HOME/geodev"
CURRENT_DIR=$PWD

if [ -z $REPO_HOME ]; then
    echo "Need a specify a base repository folder."
    exit 1
fi

cd $REPO_HOME
REPOS=`find . -type d -name .git`

for REPO in $REPOS
do
  REPO=`echo $REPO | sed 's/.git//'`
  cd "$REPO_HOME/$REPO"
  git fetch -q
# Incoming
  LOG=`git log --exit-code --oneline master..origin/master`
  RET_VALUE=$?
  if [ $RET_VALUE -gt 0 ]; then
    X=`echo $LOG | wc -l`
    echo "$REPO has $X incoming commits to pull"
  fi
# Outgoing
  LOG=`git log --exit-code --oneline origin/master..master`
  RET_VALUE=$?
  if [ $RET_VALUE -gt 0 ]; then
    X=`echo $LOG | wc -l`
    echo "$REPO has $X outgoing changes to push"
  fi
done

cd $CURRENT_DIR
